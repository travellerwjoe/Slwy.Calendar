/**
 * @preserve jquery.Slwy.Calendar.js
 * @author Joe.Wu
 * @version v1.5.3
 */
!function(e,t){"function"==typeof define&&define.amd?require(["jQuery"],t):"undefined"!=typeof module&&"object"==typeof module.exports?module.exports=t(require("jQuery")):e.SlwyCalendar=t(e.jQuery)}(this,function($){var SETTING={locales:{en_US:{daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],today:"Today",getYearMonth:function(e,t){return this.months[t]+" "+e}},zh_CN:{daysShort:["日","一","二","三","四","五","六"],days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],monthsShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],today:"今天",getYearMonth:function(e,t){return e+"年"+this.months[t]}}},getTemplate:function(e){var t='<thead><tr class="'+this.prefix+'-calendar-header"><th></th><th colspan="5" class="'+this.prefix+'-calendar-switch"><div class="'+this.prefix+'-calendar-select"></div></th><th></th></tr></thead>',a='<tbody><tr><td colspan="7"></td></tr></tbody>',s='<div class="'+this.prefix+'-calendar-table-group"><div class="'+this.prefix+'-calendar-table-group-bg"></div></div>';return{headTemplate:t,contTemplate:a,tableTemplate:'<table class="'+this.prefix+'-calendar-table">'+t+"<tbody></tbody></table>",tableGroupTemplate:s,template:'<div class="'+this.prefix+'-calendar"><div class="'+this.prefix+'-calendar-caret"></div><div class="'+this.prefix+'-calendar-action"><div class="'+this.prefix+'-calendar-prev"><i class="'+this.prefix+'-calendar-prev-icon"></i></div><div class="'+this.prefix+'-calendar-next"><i class="'+this.prefix+'-calendar-next-icon"></i></div></div><div class="'+this.prefix+'-calendar-days"></div><div class="'+this.prefix+'-calendar-months"><table class="'+this.prefix+'-calendar-table">'+t+a+'</table></div><div class="'+this.prefix+'-calendar-years"><table class="'+this.prefix+'-calendar-table">'+t+a+"</table></div></div>"}[e?e+"Template":"template"]},prefix:"Slwy",theme:{THEME_CUTE:"cute",THEME_CUTE_NOBORDER:"cute-noborder"},size:{sm:"sm"}},VARS={defaults:{locale:"zh_CN",highlightWeek:!0,onlyThisMonth:!1,showLunarAndFestival:!1,showFestival:!1,showMainFestival:!1,mainFestival:[],paneCount:1,minDate:null,maxDate:null,dateFormat:"yyyy-MM-dd",onChangeDate:null,viewMode:"days",minViewMode:"days",theme:"THEME_CUTE",invalidTips:"该日期不可选",size:null,caret:!0,paneCountOfGroup:3,weekStart:0,yearStart:1900,yearEnd:2050},festival:{"0101":"元旦","0214":"情人节","0308":"妇女节","0312":"植树节","0315":"消费者权益日","0401":"愚人节","0501":"劳动节","0504":"青年节","0512":"护士节","0601":"儿童节","0701":"建党节","0801":"建军节","0910":"教师节","0928":"孔子诞辰",1001:"国庆节",1006:"老人节",1024:"联合国日",1224:"平安夜",1225:"圣诞节"},lunarFestival:{"0101":"春节","0115":"元宵","0505":"端午","0707":"七夕","0715":"中元","0815":"中秋","0909":"重阳",1208:"腊八",1224:"小年"},mainFestival:["元旦","除夕","春节","元宵","情人节","清明","劳动节","端午","儿童节","七夕","国庆节","中秋","重阳","圣诞节"],modesName:["days","months","years"],modes:[{className:"days",name:"Days",navFnc:"Month",navStep:1,level:0},{className:"months",name:"Months",navFnc:"FullYear",navStep:1,level:1},{className:"years",name:"Years",navFnc:"FullYear",navStep:10,level:2}],events:{clickEvent:"click."+SETTING.prefix+".Calendar",focusEvent:"focus."+SETTING.prefix+".Calendar",blurEvent:"blur."+SETTING.prefix+".Calendar",keyupEvent:"keyup."+SETTING.prefix+".Calendar",keydownEvent:"keydown."+SETTING.prefix+".Calendar",inputEvent:"input."+SETTING.prefix+".Calendar",changeEvent:"change."+SETTING.prefix+".Calendar",changeDateEvent:"changeDate."+SETTING.prefix+".Calendar"},className:{active:SETTING.prefix+"-calendar-active",activeDay:SETTING.prefix+"-calendar-day-active",disabled:SETTING.prefix+"-calendar-disabled",prev:SETTING.prefix+"-calendar-prev",next:SETTING.prefix+"-calendar-next",day:SETTING.prefix+"-calendar-day",days:SETTING.prefix+"-calendar-days",old:SETTING.prefix+"-calendar-old",_new:SETTING.prefix+"-calendar-new",week:SETTING.prefix+"-calendar-week",month:SETTING.prefix+"-calendar-month",months:SETTING.prefix+"-calendar-months",year:SETTING.prefix+"-calendar-year",years:SETTING.prefix+"-calendar-years",title:SETTING.prefix+"-calendar-title",titles:SETTING.prefix+"-calendar-titles",select:SETTING.prefix+"-calendar-select",today:SETTING.prefix+"-calendar-today",lunar:SETTING.prefix+"-calendar-lunar",festival:SETTING.prefix+"-calendar-festival",action:SETTING.prefix+"-calendar-action",nocaret:SETTING.prefix+"-calendar-nocaret",caret:SETTING.prefix+"-calendar-caret",_switch:SETTING.prefix+"-calendar-switch"},limitReg:/^\$\{((?:[yY]{1}|\d+){1}(?:[\+\-]\d+)?)\}[-\/]\$\{((?:[mM]{1}|\d+){1}(?:[\+\-]\d+)?)\}[-\/]\$\{((?:l?[dD]{1}|\d+){1}(?:[\+\-]\d+)?)\}$/,pickLimitArgReg:/^\$\{(['"]([.#]\w+)['"](?:,(\{.*\}))*)\}$/},UTILS={isJqueryElement:function(e){return"object"==typeof e&&!!e.length||/^[.#]{1}[\w]+$/.test(e)},isEventOnNamespace:function(e,t,a){var s=!1,n=$._data(e[0],"events")[t];return e=$(e),n?($.each(n,function(e,t){void 0!==t.namespace&&t.namespace===a&&(s=!0)}),s):s},isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysOfYearMonth:function(e,t){return[31,UTILS.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},isSameDay:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},getValidDate:function(e){return new Date("string"==typeof e?e.replace(/(\d+)[\-\/](\d+)[\-\/](\d+).*/,"$1/$2/$3"):UTILS.setDateTimeZero(e))},setDateTimeZero:function(e){return e instanceof Date||(e=new Date),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},formatDateTime:function(e,t){"string"==typeof e&&(e=e.replace(/-/g,"/"));var a={"M+":(e="Invalid Date"!==new Date(e).toString()?new Date(e):new Date).getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds(),"D+":function(e){switch(e){case 0:return"周日";case 1:return"周一";case 2:return"周二";case 3:return"周三";case 4:return"周四";case 5:return"周五";case 6:return"周六"}}(e.getDay())};for(var s in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+s+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?a[s]:("00"+a[s]).substr((""+a[s]).length)));return t}},lunarInfo=new Array(19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448),solarTerms=new Array("小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"),solarTermsInfo=new Array(0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758),cDays=new Array("十","一","二","三","四","五","六","七","八","九"),cDays2=new Array("初","十","廿","三");function Calendar(e,t){this.opts=$.extend(!0,{},VARS.defaults,e);var a=SETTING.getTemplate();this.$calendar=$(a).appendTo("body"),this.$calendarDays=this.$calendar.find("."+VARS.className.days),this.$calendarMonths=this.$calendar.find("."+VARS.className.months),this.$calendarYears=this.$calendar.find("."+VARS.className.years),this.$calendarAction=this.$calendar.find("."+VARS.className.action),this.$srcElement=t&&$(t).length?$(t):null,this.now=new Date,this.viewDate=this.$srcElement&&this.$srcElement.val()?UTILS.getValidDate(this.$srcElement.val()):new Date,this.viewDate.setDate(1),this.activeDate=this.$srcElement&&this.$srcElement.val()?UTILS.getValidDate(this.$srcElement.val()):new Date,this.paneCount=this.opts.paneCount,this.curPaneIndex=0,this.Lunar=Lunar,this.mainFestival=$.isArray(this.opts.mainFestival)&&this.opts.mainFestival.length&&this.opts.mainFestival||VARS.mainFestival,this.viewMode=$.inArray(this.opts.viewMode,VARS.modesName)>=0?$.inArray(this.opts.viewMode,VARS.modesName):0,this.minViewMode=$.inArray(this.opts.minViewMode,VARS.modesName)>=0?$.inArray(this.opts.minViewMode,VARS.modesName):0,this.theme=SETTING.theme[this.opts.theme],this.yearStart="number"==typeof this.opts.yearStart?parseInt(this.opts.yearStart):1900,this.yearEnd="number"==typeof this.opts.yearEnd?parseInt(this.opts.yearEnd):2050,this.maxDate=new Date(this.yearEnd,0,1),this.minDate=new Date(this.yearStart,11,31),this.maxDateLimitOpts=null,this.minDateLimitOpts=null,this.maxDateElement=[],this.minDateElement=[],this.size=SETTING.size[this.opts.size],this.weekStart=parseInt(this.opts.weekStart)>=0&&parseInt(this.opts.weekStart)<7?parseInt(this.opts.weekStart):0,$.each(["minDate","maxDate"],$.proxy(function(e,t){var a=this.opts[t];this[t+"Alternative"]=[],"string"==typeof a&&(optsDates=a.split("||"),a=$.trim(optsDates[0]),this[t+"Alternative"]=optsDates.slice(1)),this.setMinOrMaxDate(t,a);for(e=0;!this[t].valueOf()&&this[t+"Alternative"][e];e++)this.setMinOrMaxDate(t,$.trim(this[t+"Alternative"][e]))},this)),this.theme&&this.$calendar.addClass(SETTING.prefix+"-calendar-"+this.theme),this.size&&this.$calendar.addClass(SETTING.prefix+"-calendar-"+this.size),this.$srcElement&&this.opts.caret||this.$calendar.addClass(VARS.className.nocaret).find("."+VARS.className.caret).remove(),this.init()}function Lunar(e){var t,a,s=0,n=(e-new Date(1900,0,31))/864e5;for(this.dayCyl=n+40,this.monCyl=14,t=1900;t<2050&&n>0;t++)n-=s=this.getLunarDaysByYear(t),this.monCyl+=12;for(n<0&&(n+=s,t--,this.monCyl-=12),this.year=t,this.yearCyl=t-1864,a=this.getLunarLeapMonthByYear(t),this.isLeap=!1,t=1;t<13&&n>0;t++)a>0&&t==a+1&&!1===this.isLeap?(--t,this.isLeap=!0,s=this.getLunarLeapDaysByYear(this.year)):s=this.getLunarDaysByYearMonth(this.year,t),!0===this.isLeap&&t==a+1&&(this.isLeap=!1),!1===this.isLeap&&this.monCyl++,n-=s;0==n&&a>0&&t==a+1&&(this.isLeap?this.isLeap=!1:(this.isLeap=!0,--t,--this.monCyl)),n<0&&(n+=s,--t,--this.monCyl),this.month=t,this.day=n+1,this.cDay=this.getChineseLunarDay(this.day),this.sTermDay1=this.getSolarTermDay(e.getFullYear(),2*e.getMonth()),this.sTermDay2=this.getSolarTermDay(e.getFullYear(),2*e.getMonth()+1),this.sTerm="",e.getDate()===this.sTermDay1?this.sTerm=solarTerms[2*e.getMonth()]:e.getDate()===this.sTermDay2&&(this.sTerm=solarTerms[2*e.getMonth()+1])}function setDefaults(e){VARS.defaults=$.extend(!0,VARS.defaults,e)}function C(e,t){"string"==typeof e&&(t=e,e={}),void 0===e&&(e={}),new Calendar(e,t)}return Calendar.prototype.init=function(){this.bind(),this.show()},Calendar.prototype.bind=function(){var e=this,t=VARS.events.clickEvent,a=VARS.events.focusEvent,s=VARS.events.blurEvent,n=VARS.events.keyupEvent,i=VARS.events.keydownEvent,r=VARS.events.inputEvent,l=VARS.events.changeEvent,o=VARS.events.changeDateEvent;function h(){if(!$(this).val())return!0;var t=new Date(UTILS.getValidDate($(this).val()));return!(!t.valueOf()||e.maxDate&&t.valueOf()>new Date(e.maxDate).valueOf()||e.minDate&&t.valueOf()<new Date(e.minDate).valueOf())||(alert(e.opts.invalidTips),$(this).val("").trigger(n).focus(),!1)}this.$srcElement&&(this.$srcElement.on(n+" "+l,function(){var t,a=$(this).val();t=a?UTILS.getValidDate(a):null,e.activeDate=t&&t.valueOf()?new Date(t):null,e.viewDate=t&&t.valueOf()?new Date(t):new Date,e.viewDate.setDate(1),e.show()}).on(i,function(t){if(9===(t.keyCode||t.which)){if(!h.call(this))return void t.preventDefault();e.close()}}).on(a,function(){e.open()}).on(s,function(){h.call(this)}),$(document).on(t,function(t){var a=$(t.target);a.is(e.$srcElement)||a.closest("."+SETTING.prefix+"-calendar").is(e.$calendar)||e.close()})),$.each(["minDate","maxDate"],function(t,a){for(var s=0;s<e[a+"Element"].length;s++)if(e[a+"Element"][s]&&e[a+"Element"][s].length){var i=e[a+"Element"][s],h=function(t){if("changeDate"!==t.type||t.namespace==="Calendar."+SETTING.prefix){var s=c(t.data.index)||t.date||$(this).val();e[a]=e.getLimitDate(UTILS.getValidDate(s),e[a+"LimitOpts"]);for(var n=0;!e[a].valueOf()&&e[a+"Alternative"][n];n++)e.setMinOrMaxDate(a,$.trim(e[a+"Alternative"][n]));e.viewDate=e.$srcElement&&e.$srcElement.val()?UTILS.getValidDate(e.$srcElement.val()):new Date,e.viewDate.setDate(1),e.activeDate=e.$srcElement?UTILS.getValidDate(e.$srcElement.val()):null,e.renderDays()}},c=function(t){for(var s=0;s<t;s++)if(e[a+"Element"][s].val())return e[a+"Element"][s].val()};i.on(o,{index:s},h).on(n+" "+r+" "+l,{index:s},h)}}),this.$calendar.on(t,function(t){t.stopPropagation();var a,s,n=$(t.target).closest("span, td, th"),i=VARS.className.activeDay,r=VARS.className.disabled,l=SETTING.prefix+"-calendar-date";if(n.is("th")&&n.hasClass(VARS.className._switch))e.show(1);else if(n.is("td")&&n.hasClass(VARS.className.day)){if(n.hasClass(r))return;u(d=n.attr(l)),e.close()}else if(n.is("span")){var c,d=n.attr(l),p=0;1===e.viewMode?(c="setMonth",p=n.index(),"renderDays"):2===e.viewMode&&(c="setFullYear","renderMonths",p=d),e.viewMode>0&&e.viewMode===e.minViewMode&&u(d),e.viewDate[c].call(e.viewDate,p),a=new Date(e.viewDate),s=e.opts.paneCount,e.viewDate.setMonth(e.viewDate.getMonth()+s-1),e.viewDate.getFullYear()>e.yearEnd&&a.setMonth(a.getMonth()-s+1),e.viewDate=a,e.show(-1)}function u(t){t=new Date(t);var a,s,r=UTILS.formatDateTime(t,e.opts.dateFormat);new Date(e.activeDate).valueOf()!==t.valueOf()&&(e.$calendarDays.find("td").removeClass(i),n.addClass(i),e.activeDate=t,a=new e.Lunar(e.activeDate),s="function"==typeof e.opts.onChangeDate&&e.opts.onChangeDate.call(e,e.activeDate,r,a,{close:$.proxy(e.close,e),open:$.proxy(e.open,e),formatDateTime:UTILS.formatDateTime}),e.$srcElement&&($.each(["changeDate",o],function(t,s){e.$srcElement.trigger({type:s,date:new Date(e.activeDate),value:r,lunarInfo:$.extend(!0,{},a),formatDateTime:UTILS.formatDateTime,close:$.proxy(e.close,e),open:$.proxy(e.open,e)})}),("function"!=typeof e.opts.onChangeDate&&!UTILS.isEventOnNamespace(e.$srcElement,"changeDate","")||s)&&(e.$srcElement.val(r),h.call(e.$srcElement))))}}),this.$calendarAction.on(t,function(t){var a=$(t.target).closest("div"),s=VARS.className.prev,n=VARS.className.next,i=VARS.modes[e.viewMode],r="set"+i.navFnc,l="get"+i.navFnc,o=i.navStep,h=new Date(e.viewDate);if(a.hasClass(s)){var c=0===e.viewMode?2*e.paneCount-o:o;e.viewDate[r].call(e.viewDate,e.viewDate[l].call(e.viewDate)-c)}else if(a.hasClass(n)){var d=o;e.viewDate[r].call(e.viewDate,e.viewDate[l].call(e.viewDate)+d)}e.viewDate.getFullYear()>e.yearEnd||e.viewDate.getFullYear()<e.yearStart?e.viewDate=h:e.show()}),$(window).on("resize",$.proxy(this.resetCalendarPos,this))},Calendar.prototype.renderDays=function(){var e=this.minDate,t=this.maxDate,a=[],s=[],n=$(SETTING.getTemplate("tableGroup"));this.$calendarDays.html(""),this.curPaneIndex=0,function i(){var r,l=this.viewDate,o=l.getFullYear(),h=l.getMonth(),c=this.now,d=new Date(o,h-1),p=d.getFullYear(),u=d.getMonth(),v=UTILS.getDaysOfYearMonth(p,u),m=nextMonthDateCount=0,f=$(SETTING.getTemplate("table")),y="",D="";for(d.setDate(v),d.setDate(v-(d.getDay()-this.weekStart+7)%7),(r=new Date(d)).setDate(r.getDate()+42),function(e){for(var t=this.weekStart,a='<tr class="'+VARS.className.titles+'">',s=t;s<t+7;s++){var n,i=VARS.className.title;!this.opts.highlightWeek||s%7!=0&&s%7!=6||(i+=" "+VARS.className.week),n='<th class="'+i+'">'+SETTING.locales[this.opts.locale].daysShort[s%7]+"</th>",a+=n}e.find("thead").append(a)}.call(this,f),startIndex=1;d.valueOf()<r.valueOf();d.setDate(d.getDate()+1),startIndex++){var T=d.getFullYear(),S=d.getMonth(),g=d.getDate(),w=d.getDay(),E=VARS.className.day,M=SETTING.prefix+'-calendar-date="'+T+"/"+(S+1)+"/"+g+'"',x=!0;T<o||T===o&&S<h?(this.opts.onlyThisMonth&&(x=!1),E+=" "+VARS.className.old,m++):(T>o||T===o&&S>h)&&(this.opts.onlyThisMonth&&(x=!1),E+=" "+VARS.className._new,nextMonthDateCount++),(e&&d.valueOf()<e.valueOf()||t&&d.valueOf()>t.valueOf())&&(E+=" "+VARS.className.disabled),0!==w&&6!==w||!this.opts.highlightWeek||(E+=" "+VARS.className.week),this.activeDate&&d.valueOf()===this.activeDate.valueOf()&&(E+=" "+VARS.className.activeDay),startIndex%7==1&&(D+="<tr>"),D+=x?'<td class="'+E+'" '+M+">"+this.getDay(d,c)+"</td>":"<td></td>",startIndex%7==0&&(D+="</tr>",!this.opts.onlyThisMonth||7!==m&&7!==nextMonthDateCount||(D=D.replace(/<tr>/,'<tr style="display:none"')),m=nextMonthDateCount=0,y+=D,D="")}f.find("tbody").html(y),f.find("."+VARS.className.select).text(SETTING.locales[this.opts.locale].getYearMonth(l.getFullYear(),l.getMonth())),a.push(f[0]),this.curPaneIndex++,this.curPaneIndex<this.paneCount&&(this.viewDate.setMonth(this.viewDate.getMonth()+1),i.call(this)),(this.curPaneIndex>0&&this.curPaneIndex%this.opts.paneCountOfGroup===this.opts.paneCountOfGroup||this.curPaneIndex===this.paneCount)&&(n.append(a),s.push(n),a=[],n=$(SETTING.getTemplate("tableGroup")))}.call(this),this.$calendarDays.append(s)},Calendar.prototype.renderMonths=function(){for(var e=this.viewDate,t=this.activeDate?this.activeDate.getFullYear():null,a=this.activeDate?this.activeDate.getMonth():null,s=VARS.className.month,n="",i=0;i<12;i++){var r=s,l=e.getFullYear(),o=SETTING.prefix+'-calendar-date="'+l+"-"+(i+1)+'"';l===t&&i===a&&(r+=" "+VARS.className.active),n+='<span class="'+r+'" '+o+">"+SETTING.locales[this.opts.locale].months[i]+"</span>"}this.$calendarMonths.find("tbody td").first().html(n),this.$calendarMonths.find("."+VARS.className.select).text(e.getFullYear())},Calendar.prototype.renderYears=function(){for(var e=this.viewDate,t=VARS.className.year,a=e.getFullYear(),s=this.activeDate?this.activeDate.getFullYear():null,n=10*parseInt(a/10),i="",r=-1;r<=10;r++){var l=t,o=n+r,h=SETTING.prefix+'-calendar-date="'+o+'"';-1===r&&(l+=" "+VARS.className.old),10===r&&(l+=" "+VARS.className._new),o===s&&(l+=" "+VARS.className.active),o>this.yearEnd||o<this.yearStart||(i+='<span class="'+l+'" '+h+">"+o+"</span>")}this.$calendarYears.find("tbody td").first().html(i),this.$calendarYears.find("."+VARS.className.select).text(n+"-"+(n+9))},Calendar.prototype.show=function(e){e&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+e)));var t="render"+VARS.modes[this.viewMode].name;this.paneCount=this.viewMode>0?1:this.opts.paneCount,this[t].call(this),this.$calendar.find(">div").hide().filter("."+SETTING.prefix+"-calendar-"+VARS.modes[this.viewMode].className).show(),this.resetCalendarStyle()},Calendar.prototype.getDay=function(e,t){var a="",s=VARS.className.today,n=VARS.className.lunar,i=VARS.className.festival;if(a=UTILS.isSameDay(e,t)?'<div class="'+s+'">'+SETTING.locales[this.opts.locale].today+"</div>":e.getDate(),this.opts.showLunarAndFestival)a+='<div class="'+n+'">'+this.getLunarAndFestival(e)+"</div>";else if(this.opts.showMainFestival||this.opts.showFestival){var r=this.getLunarAndFestival(e,{onlyReturnMainFestival:this.opts.showMainFestival,onlyReturnFestival:this.opts.showFestival});this.opts.showMainFestival&&r&&(a=""),a+=r?'<div class="'+i+'">'+r+"</div>":""}return a},Calendar.prototype.getLunarAndFestival=function(e,t){var a,s,n,i=new this.Lunar(e),r=UTILS.formatDateTime(e,"MMdd"),l=(i.month<10?"0"+i.month:i.month)+(i.day<10?"0"+i.day:i.day),o=VARS.festival[r],h=VARS.lunarFestival[l],c=i.cDay,d=i.sTerm,p={onlyReturnFestival:!1,onlyReturnMainFestival:!1};($.extend(p,t),12===i.month)&&((i.isLeap?i.getLunarLeapDaysByYear(i.year):i.getLunarDaysByYearMonth(i.year,i.month))===i.day&&(h="除夕"));return a=o||h||d||c,s=o||h||d,n=$.inArray(s,this.mainFestival)>=0&&s,p.onlyReturnMainFestival?n:p.onlyReturnFestival?s:a},Calendar.prototype.resetCalendarStyle=function(){var e=this["$calendar"+VARS.modes[this.viewMode].name].find("table"),t=this.opts.paneCountOfGroup,a=0===this.viewMode?e.width()+20:e.width();this.$calendar.width(this.paneCount>t?a*t:a*this.paneCount),this.resetCalendarPos()},Calendar.prototype.resetCalendarPos=function(){if(this.$srcElement){var e=this.$srcElement.offset(),t=this.$srcElement.outerHeight();this.$calendar.css({left:e.left,top:e.top+t,position:"absolute"})}},Calendar.prototype.open=function(){if(this.resetCalendarPos(),this.$calendar.show(),this.$srcElement&&this.$srcElement.val()){var e=this.$srcElement.val();UTILS.getValidDate(e).valueOf()!==this.activeDate.valueOf()&&(this.viewDate=UTILS.getValidDate(e),this.viewDate.setDate(1),this.activeDate=UTILS.getValidDate(e),this.show())}},Calendar.prototype.close=function(){this.$calendar.hide()},Calendar.prototype.getLimitDate=function(e,t){if(!t)return e;var a=t.d||t.D||t.day||t.Day,s=t.m||t.M||t.month||t.Month,n=t.y||t.Y||t.year||t.Year,i=t.ld||t.LD,r=t.lm||t.LM,l=e.getDate(),o=e.getMonth(),h=e.getFullYear();return e?("number"==typeof a?e.setDate(l+parseInt(a)):"boolean"==typeof a&&a?e.setDate(1):"boolean"==typeof i&&i&&e.setDate(UTILS.getDaysOfYearMonth(h,o)),"number"==typeof s?e.setMonth(o+parseInt(s)):"boolean"==typeof s&&s?(e.setMonth(0),e.setDate(1)):"boolean"==typeof r&&r&&(e.setMonth(11),e.setDate(UTILS.getDaysOfYearMonth(h,o))),"number"==typeof n&&e.setYear(h+parseInt(n)),e):void 0},Calendar.prototype.setMinOrMaxDate=function(date,optsDate){var matches;if(optsDate)if("string"==typeof optsDate&&(matches=optsDate.match(VARS.limitReg))){var matchY=matches[1],matchM=matches[2],matchD=matches[3],y=this.now.getFullYear(),m=this.now.getMonth()+1,d=this.now.getDate();matchY=eval(matchY.replace(/y/gi,y)),matchM=eval(matchM.replace(/m/gi,m)),matchD=eval(matchD.replace(/ld/gi,UTILS.getDaysOfYearMonth(y,m-1))).toString(),matchD=eval(matchD.replace(/d/gi,d)),this[date]=new Date(matchY,matchM-1,matchD)}else if("string"==typeof optsDate&&(matches=optsDate.match(VARS.pickLimitArgReg))){var selector=matches[2],limitOpts=matches[3]&&eval("("+matches[3]+")");if(UTILS.isJqueryElement(selector)){var $selector=$(selector),d=UTILS.getValidDate($(selector).val());this[date+"Element"].push($(selector)),this[date]=d.valueOf()?this.getLimitDate(UTILS.getValidDate($(selector).val()),limitOpts):d,this[date+"LimitOpts"]=limitOpts}}else UTILS.isJqueryElement(optsDate)?(this[date]=UTILS.getValidDate($(optsDate).val()),this[date+"Element"].push($(optsDate))):this[date]=UTILS.getValidDate(optsDate)},Lunar.prototype={getLunarDaysByYear:function(e){var t,a=348;for(t=32768;t>8;t>>=1)a+=lunarInfo[e-1900]&t?1:0;return a+this.getLunarLeapDaysByYear(e)},getLunarLeapDaysByYear:function(e){return this.getLunarLeapMonthByYear(e)?65536&lunarInfo[e-1900]?30:29:0},getLunarLeapMonthByYear:function(e){return 15&lunarInfo[e-1900]},getLunarDaysByYearMonth:function(e,t){return lunarInfo[e-1900]&65536>>t?30:29},getChineseLunarDay:function(e){var t=cDays2[Math.floor(e/(e<=10?11:10))];return t+=cDays[e%10]},getSolarTermDay:function(e,t){return new Date(31556925974.7*(e-1900)+6e4*solarTermsInfo[t]+Date.UTC(1900,0,6,2,5)).getUTCDate()}},C.setDefaults=setDefaults,$.fn.SlwyCalendar=function(e){return new Calendar(e,$(this)),$(this)},$.SlwyCalendar=C,C});