/**
 * @preserve jquery.Slwy.Calendar.js
 * @author Joe.Wu
 * @version v1.0.0
 */
!function(e,t){"function"==typeof define&&define.amd?require(["jQuery"],t):"undefined"!=typeof module&&"object"==typeof module.exports?module.exports=t(require("jQuery")):e.SlwyCalendar=t(e.jQuery)}(this,function(e){function t(t,s){var r={locale:"zh_CN",highlightWeek:!0,onlyThisMonth:!1,showLunarAndFestival:!1,showFestival:!1,showMainFestival:!1,mainFestival:[],paneCount:1,minDate:null,maxDate:null,dateFormat:"yyyy-MM-dd",onChangeDate:null,viewMode:"days",minViewMode:"days",theme:null,invalidTips:"该日期不可选"};this.opts=e.extend(!0,r,t);var l=n.getTemplate();this.$calender=e(l).appendTo("body"),this.$calenderDays=this.$calender.find("."+n.prefix+"-calendar-days"),this.$calenderMonths=this.$calender.find("."+n.prefix+"-calendar-months"),this.$calenderYears=this.$calender.find("."+n.prefix+"-calendar-years"),this.$calendarAction=this.$calender.find("."+n.prefix+"-calendar-action"),this.$srcElement=s&&e(s),this.now=new Date,this.viewDate=new Date,this.activeDate=this.$srcElement?i.getValidDate(this.$srcElement.val()):null,this.paneCount=this.opts.paneCount,this.curPaneCount=0,this.Lunar=a,this.mainFestival=e.isArray(this.opts.mainFestival)&&this.opts.mainFestival.length&&this.opts.mainFestival||n.mainFestival,this.viewMode=n.modesName.indexOf(this.opts.viewMode)>=0?n.modesName.indexOf(this.opts.viewMode):0,this.minViewMode=n.modesName.indexOf(this.opts.minViewMode)>=0?n.modesName.indexOf(this.opts.minViewMode):0,this.theme=n.theme[this.opts.theme],this.theme&&this.$calender.addClass(n.prefix+"-calendar-"+this.theme),this.$srcElement?this.$calender.addClass(n.prefix+"-calendar-hidden"):this.$calender.find("."+n.prefix+"-calendar-caret").remove(),this.init()}function a(e){var t,a=0,n=0,i=new Date(1900,0,31),s=(e-i)/864e5;for(this.dayCyl=s+40,this.monCyl=14,t=1900;2050>t&&s>0;t++)n=this.getLunarDaysByYear(t),s-=n,this.monCyl+=12;for(0>s&&(s+=n,t--,this.monCyl-=12),this.year=t,this.yearCyl=t-1864,a=this.getLunarLeapMonthByYear(t),this.isLeap=!1,t=1;13>t&&s>0;t++)a>0&&t==a+1&&0==this.isLeap?(--t,this.isLeap=!0,n=this.getLunarLeapDaysByYear(this.year)):n=this.getLunarDaysByYearMonth(this.year,t),1==this.isLeap&&t==a+1&&(this.isLeap=!1),0==this.isLeap&&this.monCyl++,s-=n;0==s&&a>0&&t==a+1&&(this.isLeap?this.isLeap=!1:(this.isLeap=!0,--t,--this.monCyl)),0>s&&(s+=n,--t,--this.monCyl),this.month=t,this.day=s+1,this.cDay=this.getChineseLunarDay(this.day),this.sTermDay1=this.getSolarTermDay(e.getFullYear(),2*e.getMonth()),this.sTermDay2=this.getSolarTermDay(e.getFullYear(),2*e.getMonth()+1),this.sTerm="",e.getDate()===this.sTermDay1?this.sTerm=r[2*e.getMonth()]:e.getDate()===this.sTermDay2&&(this.sTerm=r[2*e.getMonth()+1])}var n={locales:{en_US:{daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],today:"Today",getYearMonth:function(e,t){return this.months[t]+" "+e}},zh_CN:{daysShort:["日","一","二","三","四","五","六"],days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],monthsShort:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],today:"今天",getYearMonth:function(e,t){return e+"年"+this.months[t]}}},getTemplate:function(e){var t='<thead><tr class="'+this.prefix+'-calendar-header"><th></th><th colspan="5" class="'+this.prefix+'-calendar-switch"><div class="'+this.prefix+'-calendar-select"></div></th><th></th></tr></thead>',a='<tbody><tr><td colspan="7"></td></tr></tbody>',n='<table class="'+this.prefix+'-calendar-table">'+t+"<tbody></tbody></table>",i='<div class="'+this.prefix+'-calendar"><div class="'+this.prefix+'-calendar-caret"></div><div class="'+this.prefix+'-calendar-action"><div class="'+this.prefix+'-calendar-prev"><i class="'+this.prefix+'-calendar-prev-icon"></i></div><div class="'+this.prefix+'-calendar-next"><i class="'+this.prefix+'-calendar-next-icon"></i></div></div><div class="'+this.prefix+'-calendar-days"></div><div class="'+this.prefix+'-calendar-months"><table class="'+this.prefix+'-calendar-table">'+t+a+'</table></div><div class="'+this.prefix+'-calendar-years"><table class="'+this.prefix+'-calendar-table">'+t+a+"</table></div></div>",s={headTemplate:t,contTemplate:a,tableTemplate:n,template:i};return s[e?e+"Template":"template"]},festival:{"0101":"元旦","0214":"情人节","0308":"妇女节","0312":"植树节","0315":"消费者权益日","0401":"愚人节","0501":"劳动节","0504":"青年节","0512":"护士节","0601":"儿童节","0701":"建党节","0801":"建军节","0910":"教师节","0928":"孔子诞辰",1001:"国庆节",1006:"老人节",1024:"联合国日",1224:"平安夜",1225:"圣诞节"},lunarFestival:{"0101":"春节","0115":"元宵","0505":"端午","0707":"七夕","0715":"中元","0815":"中秋","0909":"重阳",1208:"腊八",1224:"小年"},mainFestival:["元旦","除夕","春节","元宵","情人节","清明","劳动节","端午","儿童节","七夕","国庆节","中秋","重阳","圣诞节"],modesName:["days","months","years"],modes:[{className:"days",name:"Days",navFnc:"Month",navStep:1,level:0},{className:"months",name:"Months",navFnc:"FullYear",navStep:1,level:1},{className:"years",name:"Years",navFnc:"FullYear",navStep:10,level:2}],prefix:"Slwy",yearStart:1990,yearEnd:2050,weekStart:0,theme:{THEME_CUTE:"cute"}},i={isJqueryInput:function(t){return e(t).is("input")},isEventOnNamespace:function(t,a,n){var i=!1,s=e._data(t[0],"events")[a];return t=e(t),s?(e.each(s,function(e,t){"undefined"!=typeof t.namespace&&t.namespace===n&&(i=!0)}),i):i},isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysOfYearMonth:function(e,t){return[31,i.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},isSameDay:function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},getValidDate:function(e){return new Date("string"==typeof e?e.replace(/(\d+)[\-\/](\d+)[\-\/](\d+).*/,"$1/$2/$3"):i.setDateTimeZero(e))},setDateTimeZero:function(e){return e instanceof Date||(e=new Date),e.setHours(0),e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),e},formatDateTime:function(e,t){function a(e){switch(e){case 0:return"周日";case 1:return"周一";case 2:return"周二";case 3:return"周三";case 4:return"周四";case 5:return"周五";case 6:return"周六"}}"string"==typeof e&&(e=e.replace(/-/g,"/")),e="Invalid Date"!==new Date(e).toString()?new Date(e):new Date;var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds(),"D+":a(e.getDay())};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n)new RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)));return t}},s=new Array(19416,19168,42352,21717,53856,55632,91476,22176,39632,21970,19168,42422,42192,53840,119381,46400,54944,44450,38320,84343,18800,42160,46261,27216,27968,109396,11104,38256,21234,18800,25958,54432,59984,28309,23248,11104,100067,37600,116951,51536,54432,120998,46416,22176,107956,9680,37584,53938,43344,46423,27808,46416,86869,19872,42448,83315,21200,43432,59728,27296,44710,43856,19296,43748,42352,21088,62051,55632,23383,22176,38608,19925,19152,42192,54484,53840,54616,46400,46496,103846,38320,18864,43380,42160,45690,27216,27968,44870,43872,38256,19189,18800,25776,29859,59984,27480,21952,43872,38613,37600,51552,55636,54432,55888,30034,22176,43959,9680,37584,51893,43344,46240,47780,44368,21977,19360,42416,86390,21168,43312,31060,27296,44368,23378,19296,42726,42208,53856,60005,54576,23200,30371,38608,19415,19152,42192,118966,53840,54560,56645,46496,22224,21938,18864,42359,42160,43600,111189,27936,44448),r=new Array("小寒","大寒","立春","雨水","惊蛰","春分","清明","谷雨","立夏","小满","芒种","夏至","小暑","大暑","立秋","处暑","白露","秋分","寒露","霜降","立冬","小雪","大雪","冬至"),l=new Array(0,21208,42467,63836,85337,107014,128867,150921,173149,195551,218072,240693,263343,285989,308563,331033,353350,375494,397447,419210,440795,462224,483532,504758),o=new Array("十","一","二","三","四","五","六","七","八","九"),h=new Array("初","十","廿","三");return t.prototype.init=function(){this.bind(),this.show()},t.prototype.bind=function(){var t=this,a="click."+n.prefix+".Calendar",s="focus."+n.prefix+".Calendar",r="blur."+n.prefix+".Calendar",l="keyup."+n.prefix+".Calendar",o="changeDate."+n.prefix+".Calendar";this.$srcElement&&(this.$srcElement.on(l,function(){var a=e(this).val(),n=a?new Date(i.formatDateTime(a,"yyyy/MM/dd")):null;t.activeDate=n,t.viewDate=n?new Date(n):new Date,t.show()}),this.$srcElement.on(s,function(){t.open()}),this.$srcElement.on(r,function(){var a=new Date(i.formatDateTime(e(this).val(),"yyyy/MM/dd"));(a.valueOf()>new Date(t.opts.maxDate).valueOf()||a.valueOf()<new Date(t.opts.minDate).valueOf())&&(alert(t.opts.invalidTips),e(this).val("").trigger(l))}),e(document).on(a,function(a){var i=e(a.target);i.is(t.$srcElement)||i.closest("."+n.prefix+"-calendar").is(t.$calender)||t.close()})),e.each(["minDate","maxDate"],function(a,s){if(t.opts[s]&&i.isJqueryInput(t.opts[s])){var r=e(t.opts[s]);r.on(o,function(e){e.namespace==="Calendar."+n.prefix&&(t.opts[s]=e.date,t.viewDate=new Date,t.activeDate=t.$srcElement?i.getValidDate(t.$srcElement.val()):null,t.renderDays())})}}),this.$calender.on(a,function(a){function s(a){var n,a=new Date(a),s=i.formatDateTime(a,t.opts.dateFormat),h=!1;new Date(t.activeDate).valueOf()!==a.valueOf()&&(t.$calenderDays.find("td").removeClass(l),r.addClass(l),t.activeDate=a,n=new t.Lunar(t.activeDate),h="function"==typeof t.opts.onChangeDate&&t.opts.onChangeDate.call(t,t.activeDate,s,n),t.$srcElement&&(e.each(["changeDate",o],function(e,a){t.$srcElement.trigger({type:a,date:t.activeDate,value:s,lunarInfo:n,close:t.close.bind(t),open:t.open.bind(t)})}),("function"!=typeof t.opts.onChangeDate&&!i.isEventOnNamespace(t.$srcElement,"changeDate","")||h)&&t.$srcElement.val(s)))}var r=e(a.target).closest("span, td, th"),l=(n.prefix+"-calendar-active",n.prefix+"-calendar-day-active"),h=n.prefix+"-calendar-disabled";if(r.is("th")&&r.hasClass(n.prefix+"-calendar-switch"))t.show(1);else if(r.is("td")&&r.hasClass(n.prefix+"-calendar-day")){if(r.hasClass(h))return;t.close();var d=r.attr(n.prefix+"-calendar-date");s(d)}else if(r.is("span")){var c,p,d=(n.modes[t.viewMode],r.attr(n.prefix+"-calendar-date")),u=0;1===t.viewMode?(c="setMonth",u=r.index(),p="renderDays"):2===t.viewMode&&(c="setFullYear",p="renderMonths",u=d),t.viewMode>0&&t.viewMode===t.minViewMode&&s(d),t.viewDate[c].call(t.viewDate,u),t.show(-1)}}),this.$calendarAction.on(a,function(a){var i=e(a.target).closest("div"),s=n.prefix+"-calendar-prev",r=n.prefix+"-calendar-next",l=n.modes[t.viewMode],o="set"+l.navFnc,h="get"+l.navFnc,d=l.navStep;if(i.hasClass(s)){var c=0===t.viewMode?2*t.paneCount-d:d;t.viewDate[o].call(t.viewDate,t.viewDate[h].call(t.viewDate)-c),t.show()}else if(i.hasClass(r)){var p=d;t.viewDate[o].call(t.viewDate,t.viewDate[h].call(t.viewDate)+p),t.show()}})},t.prototype.renderDays=function(){this.$calenderDays.html(""),this.curPaneCount=0,function t(){function a(e){for(var t=n.weekStart,a='<tr class="'+n.prefix+'-calendar-titles">',i=t;t+7>i;i++){var s,r=n.prefix+"-calendar-title ";!this.opts.highlightWeek||i%7!==0&&i%7!==6||(r+=n.prefix+"-calendar-week"),s='<th class="'+r+'">'+n.locales[this.opts.locale].daysShort[i%7],a+=s}e.find("thead").append(a)}var s,r,l,o=this.viewDate,h=o.getFullYear(),d=o.getMonth(),c=this.now,p=new Date(h,d-1),u=p.getFullYear(),f=p.getMonth(),v=i.getDaysOfYearMonth(u,f),y=e(n.getTemplate("table")),m=nextMonthDateCount=0,D="",g="";for(p.setDate(v),p.setDate(v-(p.getDay()-n.weekStart+7)%7),s=new Date(p),s.setDate(s.getDate()+42),this.opts.minDate&&(r=i.getValidDate(i.isJqueryInput(this.opts.minDate)?e(this.opts.minDate).val():this.opts.minDate)),this.opts.maxDate&&(l=i.getValidDate(i.isJqueryInput(this.opts.maxDate)?e(this.opts.maxDate).val():this.opts.maxDate)),a.call(this,y),startIndex=1;p.valueOf()<s.valueOf();p.setDate(p.getDate()+1),startIndex++){var w,x=p.getFullYear(),M=p.getMonth(),C=p.getDate(),F=p.getDay(),$=n.prefix+"-calendar-day ",L=n.prefix+'-calendar-date="'+x+"/"+(M+1)+"/"+C+'"',T=!0;h>x||x===h&&d>M?(this.opts.onlyThisMonth&&(T=!1),$+=n.prefix+"-calendar-old ",m++):(x>h||x===h&&M>d)&&(this.opts.onlyThisMonth&&(T=!1),$+=n.prefix+"-calendar-new ",nextMonthDateCount++),r&&p.valueOf()<r.valueOf()?$+=n.prefix+"-calendar-disabled ":l&&p.valueOf()>l.valueOf()&&($+=n.prefix+"-calendar-disabled "),0!==F&&6!==F||!this.opts.highlightWeek||($+=n.prefix+"-calendar-week "),this.activeDate&&p.valueOf()===this.activeDate.valueOf()&&($+=n.prefix+"-calendar-day-active "),startIndex%7===1&&(g+="<tr>"),w=T?'<td class="'+$+'" '+L+">"+this.getDay(p,c)+"</td>":"<td></td>",g+=w,startIndex%7===0&&(g+="</tr>",!this.opts.onlyThisMonth||7!==m&&7!==nextMonthDateCount||(g=g.replace(/<tr>/,'<tr style="display:none"')),m=nextMonthDateCount=0,D+=g,g="")}y.find("tbody").html(D),y.find("."+n.prefix+"-calendar-select").text(n.locales[this.opts.locale].getYearMonth(o.getFullYear(),o.getMonth())),this.$calenderDays.append(y),this.curPaneCount++,this.curPaneCount<this.paneCount&&(this.viewDate.setMonth(this.viewDate.getMonth()+1),t.call(this))}.call(this)},t.prototype.renderMonths=function(){for(var e=this.viewDate,t=this.activeDate?this.activeDate.getFullYear():null,a=this.activeDate?this.activeDate.getMonth():null,i=n.prefix+"-calendar-month",s="",r=0;12>r;r++){var l=i,o=e.getFullYear(),h=n.prefix+'-calendar-date="'+o+"-"+(r+1)+'"';o===t&&r===a&&(l+=" "+n.prefix+"-calendar-active"),s+='<span class="'+l+'" '+h+">"+n.locales[this.opts.locale].months[r]+"</span>"}this.$calenderMonths.find("tbody td").first().html(s),this.$calenderMonths.find("."+n.prefix+"-calendar-select").text(e.getFullYear())},t.prototype.renderYears=function(){for(var e=this.viewDate,t=n.prefix+"-calendar-year",a=e.getFullYear(),i=this.activeDate?this.activeDate.getFullYear():null,s=10*parseInt(a/10),r="",l=-1;10>=l;l++){var o=t,h=s+l,d=n.prefix+'-calendar-date="'+h+'"';-1===l&&(o+=" "+n.prefix+"-calendar-old"),10===l&&(o+=" "+n.prefix+"-calendar-new"),h===i&&(o+=" "+n.prefix+"-calendar-active"),r+='<span class="'+o+'" '+d+">"+h+"</span>"}this.$calenderYears.find("tbody td").first().html(r),this.$calenderYears.find("."+n.prefix+"-calendar-select").text(s+"-"+(s+9))},t.prototype.show=function(e){e&&(this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+e)));var t="render"+n.modes[this.viewMode].name;this.paneCount=this.viewMode>0?1:this.opts.paneCount,this[t].call(this),this.$calender.find(">div").hide().filter("."+n.prefix+"-calendar-"+n.modes[this.viewMode].className).show(),this.resetCalendarStyle()},t.prototype.getDay=function(e,t){var a="",s=n.prefix+"-calendar-today",r=n.prefix+"-calendar-lunar",l=n.prefix+"-calendar-festival";if(a=i.isSameDay(e,t)?'<div class="'+s+'">'+n.locales[this.opts.locale].today+"</div>":e.getDate(),this.opts.showLunarAndFestival)a+='<div class="'+r+'">'+this.getLunarAndFestival(e)+"</div>";else if(this.opts.showMainFestival||this.opts.showFestival){var o=this.getLunarAndFestival(e,{onlyReturnMainFestival:this.opts.showMainFestival,onlyReturnFestival:this.opts.showFestival});this.opts.showMainFestival&&!!o&&(a=""),a+=o?'<div class="'+l+'">'+o+"</div>":""}return a},t.prototype.getLunarAndFestival=function(t,a){var s,r,l,o=new this.Lunar(t),h=i.formatDateTime(t,"MMdd"),d=(o.month<10?"0"+o.month:o.month)+(o.day<10?"0"+o.day:o.day),c=n.festival[h],p=n.lunarFestival[d],u=o.cDay,f=o.sTerm,v={onlyReturnFestival:!1,onlyReturnMainFestival:!1};if(e.extend(v,a),12===o.month){var y=o.isLeap?o.getLunarLeapDaysByYear(o.year):o.getLunarDaysByYearMonth(o.year,o.month);y===o.day&&(p="除夕")}return s=c||p||f||u,r=c||p||f,l=this.mainFestival.indexOf(r)>=0&&r,v.onlyReturnMainFestival?l:v.onlyReturnFestival?r:s},t.prototype.resetCalendarStyle=function(){{var e=this["$calender"+n.modes[this.viewMode].name].find("table"),t=e.width();e.height()}if(this.$calender.width(this.paneCount>3?3*t:t*this.paneCount),this.$srcElement){var a=this.$srcElement.offset(),i=this.$srcElement.outerHeight();this.$calender.css({left:a.left,top:a.top+i,position:"absolute",zIndex:9999})}},t.prototype.open=function(){this.$calender.removeClass(n.prefix+"-calendar-hidden").show()},t.prototype.close=function(){this.$calender.hide()},a.prototype={getLunarDaysByYear:function(e){var t,a=348;for(t=32768;t>8;t>>=1)a+=s[e-1900]&t?1:0;return a+this.getLunarLeapDaysByYear(e)},getLunarLeapDaysByYear:function(e){return this.getLunarLeapMonthByYear(e)?65536&s[e-1900]?30:29:0},getLunarLeapMonthByYear:function(e){return 15&s[e-1900]},getLunarDaysByYearMonth:function(e,t){return s[e-1900]&65536>>t?30:29},getChineseLunarDay:function(e){var t=h[Math.floor(e/(10>=e?11:10))];return t+=o[e%10]},getSolarTermDay:function(e,t){var a=new Date(31556925974.7*(e-1900)+6e4*l[t]+Date.UTC(1900,0,6,2,5));return a.getUTCDate()}},e.fn.SlwyCalendar=function(a){return new t(a,e(this)),e(this)},function(e,a){"string"==typeof e&&(a=e,e={}),"undefined"==typeof e&&(e={}),new t(e,a)}});